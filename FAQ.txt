fFAQ
find . -name \*.war -exec sh -c 'printf "\n\nFile: {}"; unzip -l {}' ";" | less +/bootstrap.yml

ITMP0000052461

*******
Please make sure you have @EnableIDSLogging at your service’s spring-boot application class and “ccp.logger.ids.logging.enabled=true”.

ccp.logger.ids.loggerImplementation=emsConnector|consoleConnector

ccp:  
  logger: 
    ids: 
      appconfig:
        application:
          metadata:
            vendor: CCP
            product: ${spring.application.name}
            csi: 165242
            version: 1

Please find below process for SAD(IDS) logging flow and verification of events.

Flow of IDS log event
Micro service  IDS-Sink  ESB  ArcSight

Log verification
During development, console logger can be enabled so that it prints generated log events to console and don’t post to IDS-Sink.

During integration testing,                                        
1.	You can check IDS-Sink logs to see, if it posts events to ESB without errors. 
2.	If IDS-Sink posts successfully, then you can get ESB endpoint from IDS-Sink configuration.
3.	You can share ESB endpoint and transaction Id with Sumit(ss94977), for verification at ESB end.
4.	If ESB posts successfully, then you can share transaction Id with Akos(at41590) for verification at ArcSight.


  check if you have INFO log level for "com.citigroup.ccp.logging.ids"
    IDS event generated with transaction id  
  DEBUG log level for "com.citigroup.ccp.logger.ids.connector"

*******
SAD Manual
https://globalconsumer.collaborationtools.consumer.citigroup.net/sites/PlatformsDevelopment/Portal/Platform%20Rearchitecture/NGA/CSIBP/Logging/SAD%20Logging.doc

SAD mapping
https://globalconsumer.collaborationtools.consumer.citigroup.net/sites/PlatformsDevelopment/Portal/_layouts/xlviewer.aspx?id=/sites/PlatformsDevelopment/Portal/Platform%20Rearchitecture/NGA/CSIBP/Logging/IDS%20mappings.xlsx&Source=https%3A%2F%2Fglobalconsumer%2Ecollaborationtools%2Econsumer%2Ecitigroup%2Enet%2Fsites%2FPlatformsDevelopment%2FPortal%2FPlatform%2520Rearchitecture%2FForms%2FAllItems%2Easpx%3FRootFolder%3D%252Fsites%252FPlatformsDevelopment%252FPortal%252FPlatform%2520Rearchitecture%252FNGA%252FCSIBP%252FLogging%26InitialTabId%3DRibbon%252EDocument%26VisibilityContext%3DWSSTabPersistence&DefaultItemOpen=1&DefaultItemOpen=1 <https://globalconsumer.collaborationtools.consumer.citigroup.net/sites/PlatformsDevelopment/Portal/_layouts/xlviewer.aspx?id=/sites/PlatformsDevelopment/Portal/Platform%20Rearchitecture/NGA/CSIBP/Logging/IDS%20mappings.xlsx&Source=https://globalconsumer.collaborationtools.consumer.citigroup.net/sites/PlatformsDevelopment/Portal/Platform%2520Rearchitecture/Forms/AllItems.aspx?RootFolder%3D%252Fsites%252FPlatformsDevelopment%252FPortal%252FPlatform%2520Rearchitecture%252FNGA%252FCSIBP%252FLogging%26InitialTabId%3DRibbon%252EDocument%26VisibilityContext%3DWSSTabPersistence&DefaultItemOpen=1&DefaultItemOpen=1> 





*******
-XX:+PrintGC -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:+PrintGCTimeStamps -XX:+PrintTenuringDistribution -XX:+PrintGCApplicationStoppedTime -XX:+PrintGCApplicationConcurrentTime -Xloggc:/var/gemfire/locator_gc.log -XX:+UseGCLogFileRotation -XX:NumberOfGCLogFiles=10 -XX:GCLogFileSize=100M

-Dcom.sun.management.jmxremote.port=3333 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.authenticate=false

*******
gfsh>alter runtime --log-level=

all       finest    finer     fine      config    info      warning   error     severe    none

*******
CCP Auth
1. Refer latest version of ccp-auth.jar and add @EnableCCPAuth to spring boot application class
2. Enable service authorization at service level using ccp.service.auth.filter.enabled=true
3. Please have JWT configuration in place for encrypting/decrypting Service authorization token
ccp:
  sts: 
    jwt: 
      defaultContentEncAlgorithm: A128CBC-HS51
      defaultKeyEncAlgorithm: A256KW
      defaultSigningAlgorithm: HS512
      keyValidatorTaskDuration: 86400000
      keys: 
        USGCBAES256: 
          currentKey: 
            expirationDate: '05292017'
            keyName: US_GCB_JWT_KEY1
            startDate: '05012016'
          previousKey: 
            expirationDate: '05292017'
            keyName: US_GCB_JWT_KEY1
            startDate: '05012016'
        defaultAES256: 
          currentKey: 
            expirationDate: '05292017'
            keyName: US_GCB_JWT_KEY1
            startDate: '05012016'
          previousKey: 
            expirationDate: '05292017'
            keyName: US_GCB_JWT_KEY1
            startDate: '05012016'
      privateClaimsMaxSize: 10
      supportedContentEncAlgorithms: A128CBC-HS51
      supportedKeyEncAlgorithms: A256KW
      supportedSigningAlgorithms: HS512
      tokenExpirationTime: 600
      tokenNotUsedBeforeTime: 0

https://globalconsumer.collaborationtools.consumer.citigroup.net/sites/PlatformsDevelopment/Portal/Platform%20Rearchitecture/NGA/CSIBP/Design/Technical%20Design%20-%20Service%20Authorization.docx


TPS
	Server and Node Id received from Gemfire 

*******
CCP Dependency upgrade
  <parent>
    <groupId>com.citi.169073.ccp.rel</groupId>
    <artifactId>ccp-framework-starter-parent</artifactId>
    <version>RELEASE</version>
  </parent>

  <dependencyManagement>
    <dependencies>
      <dependency>
        <groupId>com.citi.169073.ccp.rel</groupId>
        <artifactId>ccp-framework-dependencies</artifactId>
        <version>RELEASE</version>
        <type>pom</type>
        <scope>import</scope>
      </dependency>
    </dependencies>
  </dependencyManagement>

  <dependency> 
    <groupId>com.gemstone.gemfire</groupId> 
    <artifactId>gemfire</artifactId> 
    <version>8.2.5</version> 
  </dependency>

*******
MQ Trace logs
  To print start up logs : -Dcom.ibm.msg.client.commonservices.trace.startup=true
  To print runtime logs (in project working directory) : -Dcom.ibm.msg.client.commonservices.trace.status=on

*******
ConfigServer password
http://user:configserveruat3Passw0rd@xlg-fdn-p-configserver-sit3.cfapps-gt1-dev.nam.nsroot.net
configserveruat2Passw0rd
Eureka password
http://user:eurekauat1Passw0rd@xlg-fdn-p-eureka-uat1.cfapps-gt1-dev.nam.nsroot.net/eureka/

******* Eureka
Disabling Eureka registration at client
  spring:     
    cloud:
      discovery:
        enabled: false 

com.netflix.eureka.DefaultEurekaServerConfig
com.netflix.eureka.registry.AbstractInstanceRegistry

Reference
https://groups.google.com/forum/#!topic/eureka_netflix/24FLU_q7d0I

*******
Env look up
https://globalconsumer.collaborationtools.consumer.citigroup.net/sites/PlatformsDevelopment/Portal/JFP/JFPReleases/Changelogs/Forms/AllItems.aspx?NoRedirect=true&RootFolder=%2fsites%2fPlatformsDevelopment%2fPortal%2fJFP%2fJFPReleases%2fChangelogs%2fGen2Foundation-Details&FolderCTID=0x012000DCF1F21011BEE5489D8B45849440D04C

*******
Policy decentralization user guide
https://globalconsumer.collaborationtools.consumer.citigroup.net/sites/PlatformsDevelopment/Portal/JFP/JFPReleases/Changelogs/CCP/L3%20Migration%20Form/NGA-App-Support-doc/PSG%20Zuul_Policy%20file_decoupling_UserGuide.docx 

1. move PSG and policy
2. update policy path
3. Update zuul route, profiles
4. clean up



*******
New E2E
  CCS - 181
  STS - 28  

*******
New service auth
1. Change defaultKeyEncAlgorithm to A256TK instead of A256KW
2. Change defaultSigningAlgorithm to HS512TK instead of HS512
3. Change supportedKeyEncAlgorithms to A256TK instead of A256KW
4. Change supportedSigningAlgorithms to HS512TK instead of HS512
  sts: 
    jwt: 
      sessionKey.enabled: false
      encryptionRequired: true
      defaultContentEncAlgorithm: A128CBC-HS51
      defaultKeyEncAlgorithm: A256TK
      defaultSigningAlgorithm: HS512TK
      keyValidatorTaskDuration: 86400000
      keys: 
        USCRSAES256: 
          currentKey: 
            expirationDate: '06292099'
            keyName: US_CRS_JWT_KEY1
            startDate: '05012016'
          previousKey: 
            expirationDate: '06292099'
            keyName: US_CRS_JWT_KEY1
            startDate: '05012016'
        defaultAES256: 
          currentKey: 
            expirationDate: '06292099'
            keyName: US_CRS_JWT_KEY1
            startDate: '05012016'
          previousKey: 
            expirationDate: '06292099'
            keyName: US_CRS_JWT_KEY1
            startDate: '05012016'
      privateClaimsMaxSize: 10
      supportedContentEncAlgorithms: A128CBC-HS51
      supportedKeyEncAlgorithms: A256TK
      supportedSigningAlgorithms: HS512TK

********Luna*********
DEV and SIT will use same SIT luna cups.
UAT and PERF will use same UAT luna cups.

https://svn.wlb3.nam.nsroot.net:9050/svn/169073/CCP/ccp-core-foundation-sit-stage/fintech_luna_sit.txt 
https://svn.wlb3.nam.nsroot.net:9050/svn/169073/CCP/corefdn-uat-stage/fintech_cxc_luna_uat.txt 
https://svn.wlb3.nam.nsroot.net:9050/svn/169073/CCP/corefdn-prod-stage/gt1-stage/manifest/GT1/luna_gt1_prod1(prod).txt
https://svn.wlb3.nam.nsroot.net:9050/svn/169073/CCP/corefdn-prod-stage/gt1-stage/manifest/GT1/luna_sw1_prod2(cob).txt 


CXC Test Data for DEV/SIT and UAT/PERF env.

/private/security/data/decrypt

DEV and SIT

{
  "encryptedSymmetricKey": "kIhuwQTZZlLjvd79Ec4jbqYdV1h3wvSHU+HsSwdr6LWh2rPKgy4kNCIS52GjOLR1cvFToGxxIzn3 aYOzTsGb8z32Ywy3Zr8pqqRu0N7Zak8g4E4qarm0AxIFkLqWbrB5jL1UwtGONrLr3sbkSqztVwZE SvhpIDF89n5HxKe70leNkylzSrpy5xeX1v6OqlAVfbSn60NJsKmzfgpEbY+Jto8RM4y6ye3SXauq rK/wJf3B0wkwkaK3hN5Bns0OleoR1/1YztnXzrR1CGfbk6ib1X1hcK82kypF8gl7FZLcCYXRSuTp qRF5GhIOJRo1sL2oYsVZPrqUye8QjgSGAXl5cQ==",
  "symmetricKeyName": "dfgdfg",
  "encryptedDataMap": {
    "routingNumber": "4SrN84LmuLjmhGX04+phwtfi6/YLXGHr1MB0aXjVaNQ=",
    "accountNumber": "PI6781NK9P0TkCqGXmwacK2vf2FKKzuHOVgqtVJ7/EU="
  }
}

UAT and PERF

{
  "encryptedSymmetricKey": "As6c0JEzxWuV2N9qIfPIdWZ5cnR+jxaD4BV5he6ffXCc1Zglg/n4DT/Z05wxUoYIqY8xj/VP9W/EO4BDULurJSWkKWh0w7fdxkjVAsv8OI0ZT6An2dTHnxSDIeG+ypuomZerSZk/m9WbXN6r6ftzy6WDb2n4ExYAvNO/S85vMjLzRs3P62bO7HuddN+aI7TSb/OKbb8AiwkB4x+XbwIcSwKBDWT9sJJAJ0q6NBihEFNaINhVCOEghlQUmhWLu5aDT8JOlG5ZoFJZMpGQpPINtjkyGKn6jYNWVg7ARtJ4Qbx7JTlDP1IEMBKqR376CUZKHu3Dust8oqjFXFGdv3iLEQ==", 
  "symmetricKeyName": "259563873818459478",
  "encryptedDataMap": {
    "routingNumber": "nPMC2zZi+5/7dadNPMyI1NAcnbqp8lRdvFsWxEJzSCA=",
    "accountNumber": "bK37cLXI51FHaPMiUHnFyvzCED7FaRR35zjhDeU2QuaHOHZ8OFxw7bS8rYBKwn9y"
  }
}

**********SDBM ReadOnly CREDS
https://svn.wlb3.nam.nsroot.net:9050/svn/164603/SBDM/UAT3/162445_BrandedCards/BRD-ELM-D-FraudEvents/BRD-ELM-D-FraudEvents.yml
nxgenusr/r152Dl68 

**********PERF PCF access
https://apps.cfsys-gt1-perf.nam.nsroot.net/organizations/81b58c22-f30f-4c01-8c4e-78b7021abfa4/spaces/887db0df-50a8-44c7-9f73-b247280f2955 
user : fidrofintech 
Password : Welcome123 

********* Single Policy file with both HRT and Non-HRT flows
https://svn.wlb3.nam.nsroot.net:9050/svn/169688/citipaas-devops/CCP/GT1UAT3/169073_PLATFORM/policy/JfpPolicy_CCP_MFA_BioAuth.json


********* PSG policy reading
/policy/readAll 
  application.policy.svn.path

/policy/federatedReadAll
  @Value("${ccp.profile.federated.policy.loading.enabled:false}")
  spring.cloud.config.server.svn.policyFetchAsyncEnabled (default=true)
  ccp:
  profile:
    policyfiles:
      154515_Sawgrass: JfpPolicy_cardscntcctr.json

configserver - CCPResourceController
                
********* CCP-Auth policy reading
@Value("${ccp.policy.load.all:false}")
  /policy/readAll 

ccp.profile.policyfile.path
ccp.profile.policyfile.fileName
  configSrvrUri + path + file

******** Cannot determine embedded database driver class for database type NONE
https://fastfoodcoding.com/tutorials/1502132811356/how-to-fix-cannot-determine-embedded-database-driver-class-for-database-type-none-in-springboot


******** Policy file issues
com.citigroup.extern.cdcla.jfp.auth.JfpPolicyException: Duplicate principal grant for principal: r=VISITOR
    This error means that in same policy file VISITOR role is defined in both locations as one of the allowedRoles.

******** Hystrix
Enable logging 
  logging.level.com.netflix.hystrix=trace

Disabling
  hystrix.command.default.execution.isolation.strategy=SEMAPHORE
  hystrix.command.default.execution.isolation.semaphore.maxConcurrentRequests=100000 
  hystrix.command.default.execution.timeout.enabled=false 
  hystrix.command.default.circuitBreaker.enabled=false
  hystrix.command.default.fallback.enabled=false 
  
  For specific command 
  @HystrixCommand(ignoreExceptions = {InvalidRequestException.class}, commandKey = "putCustDemoDataHystrixCmd", fallbackMethod = "putCustDemoDataFallback",   threadPoolKey="puttCustDemoDataHystrixThreadPoolKey") 
  
  hystrix.command.putCustDemoDataHystrixCmd.execution.isolation.strategy=SEMAPHORE
  hystrix.command.putCustDemoDataHystrixCmd.execution.isolation.semaphore.maxConcurrentRequests=100000 
  hystrix.command.putCustDemoDataHystrixCmd.execution.timeout.enabled=false 
  hystrix.command.putCustDemoDataHystrixCmd.circuitBreaker.enabled=false
  hystrix.command.putCustDemoDataHystrixCmd.fallback.enabled=false 

******** Config as code
2 templates
  f2_169073_PLATFORM_SVN_ARGS
    182790
    signontpscrudservice-uat1.properties
  f2_169073_PLATFORM_SVN_COMMON_DEPLOY
    182690
    signontpscrudservice.properties

******** Gemfire
multiTenancy:
  tenantProperties:
    tenantId: <unique_tenantId>
    gemfire:
      locators:
      freeConnectionTimeout: 
      idleTimeout: 
      connectionPoolSize: 
      singleHopEnabled: 
      readTimeout: 
      retryAttempts: 
      socketBufferSize: 
      poolSubscriptionEnabled: 

******** CTI SVN
https://svn.wlb3.nam.nsroot.net:9050/svn/168469/CTI-PCF/NAM/GT1PROD/
fusionc/fusionc

******** Enable logging 
Hystrix
  logging.level.com.netflix.hystrix=trace

Default RESTTemplate
  org.springframework.web
  sun.net.www.protocol.http.HttpURLConnection = DEBUG

  DEBUG [nio-8080-exec-7] n.h.s.p.HystrixPropertiesChainedProperty c.n.h.s.p.HystrixPropertiesChainedProperty$ChainLink.checkAndFlip(HystrixPropertiesChainedProperty.java:93) - GET|/wealth/insights/cashFlow/customers/1001111359942/spend|3272462d-38d5-4a5e-97d9-e6e1f94fe13e|a7c3b36a-6652-4c4e-b8fd-f0e1908c7a02|US|GCB|MOB|1001111359942||19ec18cc-9580-43d5-8449-90cd2e13edb1||psg|psg||Flipping property: hystrix.command.updateTransactionFeatures.execution.isolation.strategy to use NEXT property: hystrix.command.default.execution.isolation.strategy = THREAD

JMS-SINK
  com.citigroup.ccp.connector
  org.springframework.integration
  org.springframework.messaging
HTTP-SINK
  com.citigroup.ccp.connector.http
  org.springframework.integration
  org.springframework.messaging

SSL Logs
  -Djavax.net.debug=all

Classpath issues
  org.springframework.core.io.support.PathMatchingResourcePatternResolver = debug
  org.springframework.boot.logging.ClasspathLoggingApplicationListener = DEBUG
  org.springframework.boot.autoconfigure.logging.AutoConfigurationReportLoggingInitializer = debug

******* http-sink
http.crud.enable=true


******* RLM Jenkins lables
jenkins-169073.ccpv3.0.microsrvc.ccs.rel.build-185
jenkins-169073.ccpv3.0.microsrvc.psg.rel.build-78
jenkins-169073.ccpv3.0.microsrvc.sso.rel.build-31
jenkins-169073.ccpv3.0.microsrvc.SecurityTokenService.rel.build-30
jenkins-169073.ccpv3.0.microsrvc.configserver.rel.build-47
jenkins-169073.ccpv3.0.microsrvc.eureka.rel.build-16
jenkins-169073.ccpv3.0.microsrvc.tps-service.rel.build-conta
jenkins-169073.ccpv3.0.microsrvc.ids.sink.rel.build-17

jenkins-169073.ccpv3.0.microsrvc.ids.sink.config.rel.build-12

******** MIS logging
Please confirm below items are taken care.
1. Spring-boot application is annotated with @MISLoggingConfig
2. Method which needs to do MIS logging is annotated with @MIS

If above thngs are taken care and still failing
1. Enable DEBUG log for "com.citigroup.ccp.logging.mis" and share logs.